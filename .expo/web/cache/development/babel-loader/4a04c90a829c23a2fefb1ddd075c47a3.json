{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"/Users/jamesyeap1/freshie/node_modules/react-native-ui-lib/src/components/tabController/index.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport _pt from \"prop-types\";\nimport React, { Component } from 'react';\nimport _ from 'lodash';\nimport Reanimated, { Easing as _Easing, EasingNode } from 'react-native-reanimated';\nimport { State } from 'react-native-gesture-handler';\nimport { timing, fract, between } from 'react-native-redash';\nimport { Constants } from \"../../helpers\";\nimport { asBaseComponent } from \"../../commons/new\";\nimport TabBarContext from \"./TabBarContext\";\nimport TabBar from \"./TabBar\";\nimport TabBarItem, { TabControllerItemProps } from \"./TabBarItem\";\nimport TabPage from \"./TabPage\";\nimport PageCarousel from \"./PageCarousel\";\nexport { TabControllerItemProps };\nvar and = Reanimated.and,\n    abs = Reanimated.abs,\n    cond = Reanimated.cond,\n    call = Reanimated.call,\n    Code = Reanimated.Code,\n    Clock = Reanimated.Clock,\n    clockRunning = Reanimated.clockRunning,\n    diff = Reanimated.diff,\n    eq = Reanimated.eq,\n    floor = Reanimated.floor,\n    greaterThan = Reanimated.greaterThan,\n    lessThan = Reanimated.lessThan,\n    neq = Reanimated.neq,\n    not = Reanimated.not,\n    set = Reanimated.set,\n    Value = Reanimated.Value,\n    block = Reanimated.block,\n    onChange = Reanimated.onChange,\n    _interpolate = Reanimated.interpolate,\n    interpolateNode = Reanimated.interpolateNode,\n    round = Reanimated.round,\n    multiply = Reanimated.multiply;\nvar Easing = EasingNode || _Easing;\nvar interpolate = interpolateNode || _interpolate;\n\nvar TabController = function (_Component) {\n  _inherits(TabController, _Component);\n\n  var _super = _createSuper(TabController);\n\n  function TabController(props) {\n    var _this;\n\n    _classCallCheck(this, TabController);\n\n    _this = _super.call(this, props);\n\n    _this.registerTabItems = function (tabItemsCount, ignoredItems) {\n      var itemStates = _.times(tabItemsCount, function () {\n        return new Value(State.UNDETERMINED);\n      });\n\n      _this.setState({\n        itemStates: itemStates,\n        ignoredItems: ignoredItems\n      });\n    };\n\n    _this.onPageChange = function (_ref) {\n      var _ref2 = _slicedToArray(_ref, 1),\n          index = _ref2[0];\n\n      _.invoke(_this.props, 'onChangeIndex', index);\n    };\n\n    _this.renderCodeBlock = _.memoize(function () {\n      var _this$state = _this.state,\n          itemStates = _this$state.itemStates,\n          ignoredItems = _this$state.ignoredItems,\n          currentPage = _this$state.currentPage,\n          targetPage = _this$state.targetPage,\n          carouselOffset = _this$state.carouselOffset,\n          containerWidth = _this$state.containerWidth;\n      var selectedIndex = _this.props.selectedIndex;\n      var clock = new Clock();\n      var fromPage = new Value(selectedIndex);\n      var toPage = new Value(selectedIndex);\n      var isAnimating = new Value(0);\n      var isScrolling = new Value(0);\n\n      var _carouselOffsetDiff = new Value(0);\n\n      return React.createElement(Code, {\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 12\n        }\n      }, function () {\n        return block([].concat(_toConsumableArray(_.map(itemStates, function (state, index) {\n          var ignoredItem = _.includes(ignoredItems, index);\n\n          return [onChange(state, cond(and(eq(state, State.END), !ignoredItem), [set(fromPage, toPage), set(toPage, index), set(targetPage, index)]))];\n        })), [cond(neq(currentPage, toPage), [set(isAnimating, 1), set(currentPage, timing({\n          clock: clock,\n          from: fromPage,\n          to: toPage,\n          duration: 280,\n          easing: Easing.bezier(0.34, 1.3, 0.64, 1)\n        }))]), cond(and(eq(isAnimating, 1), not(clockRunning(clock))), set(isAnimating, 0)), onChange(carouselOffset, [set(_carouselOffsetDiff, round(abs(diff(carouselOffset)))), set(isScrolling, and(lessThan(_carouselOffsetDiff, round(containerWidth)), greaterThan(_carouselOffsetDiff, 0))), cond(not(isAnimating), [set(currentPage, interpolate(round(carouselOffset), {\n          inputRange: itemStates.map(function (_v, i) {\n            return round(multiply(i, containerWidth));\n          }),\n          outputRange: itemStates.map(function (_v, i) {\n            return i;\n          })\n        })), set(toPage, currentPage)])]), cond(and(eq(isScrolling, 1), eq(floor(abs(diff(carouselOffset))), 0)), [set(isScrolling, 0), cond(not(between(fract(currentPage), 0.1, 0.9, true)), set(targetPage, round(currentPage)))]), onChange(targetPage, call([targetPage], _this.onPageChange))]));\n      });\n    });\n    var _itemStates = [];\n    var _ignoredItems = [];\n\n    if (props.items) {\n      var itemsCount = _.chain(props.items).filter(function (item) {\n        return !item.ignore;\n      }).size().value();\n\n      _itemStates = _.times(itemsCount, function () {\n        return new Value(State.UNDETERMINED);\n      });\n      _ignoredItems = _.filter(props.items, function (item) {\n        return item.ignore;\n      });\n    }\n\n    _this.state = {\n      selectedIndex: _this.props.selectedIndex,\n      asCarousel: _this.props.asCarousel,\n      pageWidth: _this.pageWidth,\n      items: props.items,\n      itemStates: _itemStates,\n      ignoredItems: _ignoredItems,\n      targetPage: new Value(_this.props.selectedIndex),\n      currentPage: new Value(_this.props.selectedIndex),\n      carouselOffset: new Value(_this.props.selectedIndex * Math.round(_this.pageWidth)),\n      containerWidth: new Value(_this.pageWidth),\n      registerTabItems: _this.registerTabItems,\n      onChangeIndex: _this.props.onChangeIndex\n    };\n    return _this;\n  }\n\n  _createClass(TabController, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(_prevProps, prevState) {\n      if (prevState.pageWidth !== this.state.pageWidth) {\n        this.state.containerWidth.setValue(this.state.pageWidth);\n      }\n    }\n  }, {\n    key: \"pageWidth\",\n    get: function get() {\n      return this.props.carouselPageWidth || Constants.screenWidth;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var itemStates = this.state.itemStates;\n      return React.createElement(TabBarContext.Provider, {\n        value: this.state,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 12\n        }\n      }, this.props.children, !_.isEmpty(itemStates) && this.renderCodeBlock());\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(nextProps, prevState) {\n      if (!_.isUndefined(nextProps.carouselPageWidth) && nextProps.carouselPageWidth !== prevState.pageWidth) {\n        return {\n          pageWidth: nextProps.carouselPageWidth\n        };\n      }\n\n      return null;\n    }\n  }]);\n\n  return TabController;\n}(Component);\n\nTabController.propTypes = {\n  items: _pt.array.isRequired,\n  selectedIndex: _pt.number,\n  onChangeIndex: _pt.func,\n  asCarousel: _pt.bool,\n  carouselPageWidth: _pt.number\n};\nTabController.displayName = 'TabController';\nTabController.contextType = TabBarContext;\nTabController.defaultProps = {\n  selectedIndex: 0,\n  activeOpacity: 0.2\n};\nTabController.TabBar = TabBar;\nTabController.TabBarItem = TabBarItem;\nTabController.TabPage = TabPage;\nTabController.PageCarousel = PageCarousel;\nexport default asBaseComponent(TabController);","map":{"version":3,"sources":["/Users/jamesyeap1/freshie/node_modules/react-native-ui-lib/src/components/tabController/index.js"],"names":["_pt","React","Component","_","Reanimated","Easing","_Easing","EasingNode","State","timing","fract","between","Constants","asBaseComponent","TabBarContext","TabBar","TabBarItem","TabControllerItemProps","TabPage","PageCarousel","and","abs","cond","call","Code","Clock","clockRunning","diff","eq","floor","greaterThan","lessThan","neq","not","set","Value","block","onChange","_interpolate","interpolate","interpolateNode","round","multiply","TabController","props","registerTabItems","tabItemsCount","ignoredItems","itemStates","times","UNDETERMINED","setState","onPageChange","index","invoke","renderCodeBlock","memoize","state","currentPage","targetPage","carouselOffset","containerWidth","selectedIndex","clock","fromPage","toPage","isAnimating","isScrolling","_carouselOffsetDiff","map","ignoredItem","includes","END","from","to","duration","easing","bezier","inputRange","_v","i","outputRange","items","itemsCount","chain","filter","item","ignore","size","value","asCarousel","pageWidth","Math","onChangeIndex","_prevProps","prevState","setValue","carouselPageWidth","screenWidth","children","isEmpty","nextProps","isUndefined","propTypes","array","isRequired","number","func","bool","displayName","contextType","defaultProps","activeOpacity"],"mappings":"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","sourcesContent":["import _pt from \"prop-types\";\n// TODO: support commented props\nimport React, { Component } from 'react';\nimport _ from 'lodash';\nimport Reanimated, { Easing as _Easing, EasingNode } from 'react-native-reanimated';\nimport { State } from 'react-native-gesture-handler';\nimport { timing, fract, between } from 'react-native-redash';\nimport { Constants } from \"../../helpers\";\nimport { asBaseComponent } from \"../../commons/new\";\nimport TabBarContext from \"./TabBarContext\";\nimport TabBar from \"./TabBar\";\nimport TabBarItem, { TabControllerItemProps } from \"./TabBarItem\";\nimport TabPage from \"./TabPage\";\nimport PageCarousel from \"./PageCarousel\";\nexport { TabControllerItemProps };\nconst {\n  and,\n  abs,\n  cond,\n  call,\n  Code,\n  Clock,\n  clockRunning,\n  diff,\n  eq,\n  floor,\n  greaterThan,\n  lessThan,\n  neq,\n  not,\n  set,\n  Value,\n  block,\n  onChange,\n  interpolate: _interpolate,\n  interpolateNode,\n  round,\n  multiply\n} = Reanimated;\nconst Easing = EasingNode || _Easing;\nconst interpolate = interpolateNode || _interpolate;\n\n/**\n * @description: A performant solution for a tab controller with lazy load mechanism\n * @example: https://github.com/wix/react-native-ui-lib/blob/master/demo/src/screens/componentScreens/TabControllerScreen/index.tsx\n * @notes: This component is based on react-native-gesture-handler\n * @important: On Android, if using react-native-navigation, make sure to wrap your screen with gestureHandlerRootHOC\n * @importantLink: https://kmagiera.github.io/react-native-gesture-handler/docs/getting-started.html#with-wix-react-native-navigation-https-githubcom-wix-react-native-navigation\n * @gif: https://github.com/wix/react-native-ui-lib/blob/master/demo/showcase/TabController/Default.gif?raw=true, https://github.com/wix/react-native-ui-lib/blob/master/demo/showcase/TabController/PageCarousel.gif?raw=true, https://github.com/wix/react-native-ui-lib/blob/master/demo/showcase/TabController/CenterSelected.gif?raw=true\n */\nclass TabController extends Component {\n  static propTypes = {\n    /**\n       * The list of tab bar items\n       */\n    items: _pt.array.isRequired,\n\n    /**\n       * Initial selected index\n       */\n    selectedIndex: _pt.number,\n\n    /**\n       * callback for when index has change (will not be called on ignored items)\n       */\n    onChangeIndex: _pt.func,\n\n    /**\n       * When using TabController.PageCarousel this should be turned on\n       */\n    asCarousel: _pt.bool,\n\n    /**\n       * Pass for custom carousel page width\n       */\n    carouselPageWidth: _pt.number\n  };\n  static displayName = 'TabController';\n  static contextType = TabBarContext;\n  static defaultProps = {\n    selectedIndex: 0,\n    activeOpacity: 0.2\n  };\n\n  constructor(props) {\n    super(props);\n    let itemStates = []; // TODO: typescript?\n\n    let ignoredItems = []; // TODO: typescript?\n\n    if (props.items) {\n      const itemsCount = _.chain(props.items).filter(item => !item.ignore).size().value();\n\n      itemStates = _.times(itemsCount, () => new Value(State.UNDETERMINED));\n      ignoredItems = _.filter(props.items, item => item.ignore);\n    }\n\n    this.state = {\n      selectedIndex: this.props.selectedIndex,\n      asCarousel: this.props.asCarousel,\n      pageWidth: this.pageWidth,\n      // items\n      items: props.items,\n      itemStates,\n      ignoredItems,\n      // animated values\n      targetPage: new Value(this.props.selectedIndex),\n      currentPage: new Value(this.props.selectedIndex),\n      carouselOffset: new Value(this.props.selectedIndex * Math.round(this.pageWidth)),\n      containerWidth: new Value(this.pageWidth),\n      // callbacks\n      registerTabItems: this.registerTabItems,\n      onChangeIndex: this.props.onChangeIndex\n    };\n  }\n\n  static getDerivedStateFromProps(nextProps, prevState) {\n    if (!_.isUndefined(nextProps.carouselPageWidth) && nextProps.carouselPageWidth !== prevState.pageWidth) {\n      return {\n        pageWidth: nextProps.carouselPageWidth\n      };\n    }\n\n    return null;\n  }\n\n  componentDidUpdate(_prevProps, prevState) {\n    if (prevState.pageWidth !== this.state.pageWidth) {\n      this.state.containerWidth.setValue(this.state.pageWidth);\n    }\n  }\n\n  get pageWidth() {\n    return this.props.carouselPageWidth || Constants.screenWidth;\n  }\n\n  registerTabItems = (tabItemsCount, ignoredItems) => {\n    const itemStates = _.times(tabItemsCount, () => new Value(State.UNDETERMINED));\n\n    this.setState({\n      itemStates,\n      ignoredItems\n    });\n  };\n  onPageChange = ([index]) => {\n    _.invoke(this.props, 'onChangeIndex', index);\n  };\n  renderCodeBlock = _.memoize(() => {\n    const {\n      itemStates,\n      ignoredItems,\n      currentPage,\n      targetPage,\n      carouselOffset,\n      containerWidth\n    } = this.state;\n    const {\n      selectedIndex\n    } = this.props;\n    const clock = new Clock();\n    const fromPage = new Value(selectedIndex);\n    const toPage = new Value(selectedIndex);\n    const isAnimating = new Value(0);\n    const isScrolling = new Value(0); // temps\n\n    const _carouselOffsetDiff = new Value(0);\n\n    return <Code>\n        {() => block([\n      /* Page change by TabBar */\n      ..._.map(itemStates, (state, index) => {\n        const ignoredItem = _.includes(ignoredItems, index);\n\n        return [onChange(state, // @ts-ignore TODO: typescript?\n        cond(and(eq(state, State.END), !ignoredItem), [set(fromPage, toPage), set(toPage, index), set(targetPage, index)]))];\n      }), // Animate currentPage to its target\n      cond(neq(currentPage, toPage), [set(isAnimating, 1), set(currentPage, // @ts-ignore reanimated2\n      timing({\n        clock,\n        from: fromPage,\n        to: toPage,\n        duration: 280,\n        easing: Easing.bezier(0.34, 1.3, 0.64, 1)\n      }))]), // Set isAnimating flag off\n      cond(and(eq(isAnimating, 1), not(clockRunning(clock))), set(isAnimating, 0)),\n      /* Page change by Carousel scroll */\n      onChange(carouselOffset, [set(_carouselOffsetDiff, round(abs(diff(carouselOffset)))), set(isScrolling, and(lessThan(_carouselOffsetDiff, round(containerWidth)), greaterThan(_carouselOffsetDiff, 0))), cond(not(isAnimating), [set(currentPage, interpolate(round(carouselOffset), {\n        inputRange: itemStates.map((_v, i) => round(multiply(i, containerWidth))),\n        outputRange: itemStates.map((_v, i) => i)\n      })), set(toPage, currentPage)])]), // Update/Sync target page when scrolling is done\n      cond(and(eq(isScrolling, 1), eq(floor(abs(diff(carouselOffset))), 0)), [set(isScrolling, 0), cond(not(between(fract(currentPage), 0.1, 0.9, true)), set(targetPage, round(currentPage)))]),\n      /* Invoke index change */\n      onChange(targetPage, call([targetPage], this.onPageChange))])}\n      </Code>;\n  });\n\n  render() {\n    const {\n      itemStates\n    } = this.state;\n    return <TabBarContext.Provider value={this.state}>\n        {this.props.children}\n        {!_.isEmpty(itemStates) && this.renderCodeBlock()}\n      </TabBarContext.Provider>;\n  }\n\n}\n\nTabController.TabBar = TabBar;\nTabController.TabBarItem = TabBarItem;\nTabController.TabPage = TabPage;\nTabController.PageCarousel = PageCarousel;\nexport default asBaseComponent(TabController);"]},"metadata":{},"sourceType":"module"}